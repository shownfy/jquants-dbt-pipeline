version: 2

models:
  - name: dim_company
    description: "会社ディメンション - 上場企業のマスタ情報"
    columns:
      - name: company_code
        description: "銘柄コード（PK）"
        tests:
          - not_null
          - unique
      - name: company_name
        description: "会社名"
        tests:
          - not_null
      - name: company_name_english
        description: "会社名（英語）"
      - name: sector_17_code
        description: "17業種コード"
      - name: sector_17_name
        description: "17業種名"
      - name: sector_33_code
        description: "33業種コード"
      - name: sector_33_name
        description: "33業種名"
      - name: scale_category
        description: "規模区分"
      - name: market_code
        description: "市場コード"
      - name: market_name
        description: "市場名"

  - name: dim_date
    description: "日付ディメンション - カレンダー情報"
    columns:
      - name: date
        description: "日付（PK）"
        tests:
          - not_null
          - unique
      - name: year
        description: "年"
      - name: quarter
        description: "四半期（1-4）"
      - name: month
        description: "月"
      - name: day
        description: "日"
      - name: day_of_week
        description: "曜日番号（0=日曜, 1=月曜, ...）"
      - name: day_name
        description: "曜日名"
      - name: is_weekend
        description: "週末フラグ"
      - name: fiscal_year
        description: "会計年度（日本: 4月始まり）"
      - name: fiscal_quarter
        description: "会計四半期"

  - name: fct_stock_prices
    description: "株価ファクト - 日次株価データ"
    columns:
      - name: company_code
        description: "銘柄コード（FK -> dim_company）"
        tests:
          - not_null
          - relationships:
              to: ref('dim_company')
              field: company_code
      - name: date
        description: "日付（FK -> dim_date）"
        tests:
          - not_null
          - relationships:
              to: ref('dim_date')
              field: date
      - name: open_price
        description: "始値"
      - name: high_price
        description: "高値"
      - name: low_price
        description: "安値"
      - name: close_price
        description: "終値"
      - name: volume
        description: "出来高"
      - name: turnover_value
        description: "売買代金"
      - name: adjusted_close
        description: "調整後終値"


